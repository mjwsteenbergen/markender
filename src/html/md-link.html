<template id="md-link">
    
</template>

<script>
    // Refers to the "importer", which is index.html
    var thatDoc = document;
    // Refers to the "importee", which is src/hello-world.html
    var thisDoc =  (thatDoc._currentScript || thatDoc.currentScript).ownerDocument;
    // Gets content from <template>
    var mdLink = thisDoc.querySelector('#md-link').content;

    class MdLink extends HTMLElement {
        
        static get observedAttributes() {return ['name', 'href']; }

        connectedCallback() {
            

            var clone = document.importNode(mdLink, true);            
            var reference = document.createElement("a");

            reference.innerText = "NOT CONNECTED";

            clone.appendChild(reference);

            this.appendChild(clone);

            var storage = this.getLinkStorageOrCreate();
            var ref = storage.subscribe(this);
        }

        getLinkStorageOrCreate() {
            var storage = document.getElementsByTagName("md-link-storage");
            if(storage.length > 0) {
                return storage[0];
            } else {
                var storage = document.createElement("md-link-storage");
                document.body.appendChild(storage);
                return storage;
            }

        }

        attributeChangedCallback(attr, oldValue, newValue) {
            if (attr === 'name') {
                this.getElementsByTagName("a")[0].innerHTML = newValue;
            }
            if(attr === 'href') {
                this.getElementsByTagName("a")[0].setAttribute('href', newValue);
            }
        }

    }
    window.customElements.define('md-link', MdLink);
</script>